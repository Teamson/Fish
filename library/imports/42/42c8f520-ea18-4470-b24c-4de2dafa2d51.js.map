{"version":3,"sources":["assets\\Scripts\\UI\\LoadingUI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WxApi from \"../Libs/WxApi\";\r\nimport HttpMgr from \"../Mod/HttpMgr\";\r\nimport ShareMgr from \"../Mod/ShareMgr\";\r\nimport AdMgr from \"../Mod/AdMgr\";\r\nimport SoundMgr from \"../Mod/SoundMgr\";\r\nimport PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport JJMgr from \"../../ExportLibs/ExportUtils\";\r\nimport TimeCountMgr from \"../Libs/TimeCountMgr\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LoadingUI extends cc.Component {\r\n\r\n    @property(cc.ProgressBar)\r\n    pBar: cc.ProgressBar = null\r\n\r\n    onLoad() {\r\n        //localStorage.clear()\r\n        cc.director.getCollisionManager().enabled = true\r\n        cc.director.getPhysicsManager().enabled = true\r\n        //cc.director.getPhysicsManager().debugDrawFlags = 1\r\n        cc.find('ExportNode').zIndex = 999\r\n        cc.game.addPersistRootNode(cc.find('ExportNode'))\r\n\r\n        //AdMgr.instance.initAd()\r\n\r\n        WxApi.WxOnHide(() => {\r\n            localStorage.setItem('lastDate', new Date().getDate().toString())\r\n            localStorage.setItem('front_share_number', WxApi.front_share_number.toString())\r\n        })\r\n    }\r\n\r\n    start() {\r\n        WxApi.aldEvent('进入游戏加载页的人数')\r\n        JJMgr.instance.initJJ(WxApi.version, () => {\r\n            ShareMgr.instance.initShare()\r\n            PlayerDataMgr.powerMax = JJMgr.instance.exportCfg.front_energy_value\r\n            PlayerDataMgr.getPlayerData()\r\n            WxApi.calculateShareNumber()\r\n            //获取场景值\r\n            if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n                WxApi.sceneId = WxApi.GetLaunchPassVar().scene\r\n                console.log('sceneId:', WxApi.sceneId)\r\n            }\r\n\r\n            let self = this\r\n            if (!CC_WECHATGAME) {\r\n                cc.director.preloadScene('StartScene', (completeCount: number, totalCount: number) => {\r\n                    self.pBar.progress = completeCount / totalCount\r\n                }, () => {\r\n                    WxApi.aldEvent('成功加载进入游戏内人数')\r\n                    cc.director.loadScene('StartScene')\r\n                })\r\n            } else {\r\n                cc.loader.downloader.loadSubpackage('Texture', (err) => {\r\n                    if (err) {\r\n                        return console.error(err);\r\n                    }\r\n                    cc.director.preloadScene('StartScene', (completeCount: number, totalCount: number) => {\r\n                        self.pBar.progress = completeCount / totalCount\r\n                    }, () => {\r\n                        WxApi.aldEvent('成功加载进入游戏内人数')\r\n                        cc.director.loadScene('StartScene')\r\n                    })\r\n                    console.log('load subpackage successfully.');\r\n                });\r\n            }\r\n            // SoundMgr.Share.loadSounds(() => {\r\n            //     cc.director.preloadScene('StartScene', (completeCount: number, totalCount: number) => {\r\n            //         this.pBar.progress = completeCount / totalCount\r\n            //     }, () => {\r\n            //         WxApi.aldEvent('成功加载进入游戏内人数')\r\n            //         cc.director.loadScene('StartScene')\r\n            //     })\r\n            // })\r\n        })\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}