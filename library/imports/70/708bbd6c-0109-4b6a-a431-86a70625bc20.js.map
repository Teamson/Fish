{"version":3,"sources":["assets\\ExportLibs\\ExportUtils.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import JJHttp from \"./ExportHttpUtils\";\r\nimport ExportCrl from \"./ExportCrl\";\r\nimport WxApi from \"../Scripts/Libs/WxApi\";\r\n\r\nexport enum ExportDir {\r\n    VIEW_FRIENDGAME = 'FriendGameUI',   //好友都在玩的爆款游戏弹窗\r\n    VIEW_SCROLLUI = 'ScrollUI',         //游戏内滚动导出栏\r\n    VIEW_RECOMMENDUI = 'RecommendUI',   //热门推荐全屏幕导出页\r\n    VIEW_FULLGAMEUI = 'FullGameUI',     //全屏幕导出页\r\n    VIEW_FINISHGAMEUI = 'FinishGameUI', //结算页 6 个 icon\r\n    VIEW_DRAWUI = 'DrawUI',             //抽屉\r\n    VIEW_PROGRAMUI = 'ProgramUI',       //游戏列表\r\n    VIEW_WECHATUI = 'WeChatUI'\r\n}\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class JJMgr {\r\n\r\n    private static _instance: JJMgr\r\n    public static get instance(): JJMgr {\r\n        if (!this._instance) {\r\n            this._instance = new JJMgr()\r\n        }\r\n        return this._instance\r\n    }\r\n\r\n    exportCfg: any = null\r\n    navigateAppArr: any[] = []\r\n\r\n    url: string = 'https://tthy.jiujiuhuyu.com/wx/bwmrenyu/config.json?version='\r\n\r\n    isFinished: boolean = false\r\n\r\n    initJJ(version: string = '1.0.0', completeCB?: Function) {\r\n        JJHttp.instance.httpGet(this.url + version, (res) => {\r\n            console.log('JJ config.json:', res)\r\n            this.exportCfg = res.data.config\r\n            this.navigateAppArr = res.data.mores.remen_game\r\n            this.isFinished = true\r\n            completeCB && completeCB()\r\n        })\r\n    }\r\n\r\n    //显示UI\r\n    showExportUI(dir: ExportDir, param?: any, callback?: Function) {\r\n        if (!this.exportCfg.front_all_export_switch && callback) {\r\n            callback()\r\n            return\r\n        } else if (!this.exportCfg.front_all_export_switch) {\r\n            return\r\n        }\r\n        cc.find('ExportNode').getComponent(ExportCrl).showJJUI(dir, param, callback)\r\n    }\r\n\r\n    //关闭UI\r\n    closeExportUI(dir: ExportDir) {\r\n        cc.find('ExportNode').getComponent(ExportCrl).closeJJUI(dir)\r\n    }\r\n\r\n    closeAllExportUI() {\r\n        cc.find('ExportNode').getComponent(ExportCrl).closeAllJJUI()\r\n    }\r\n\r\n    //跳转\r\n    NavigateApp(index: number, cancelCB?: Function, successCB?: Function) {\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            WxApi.aldEvent('导出-总点击数')\r\n            window['wx'].navigateToMiniProgram({\r\n                appId: this.navigateAppArr[index].appid,\r\n                path: this.navigateAppArr[index].path,\r\n                success: (res) => {\r\n                    // 打开成功\r\n                    successCB && successCB()\r\n                    WxApi.aldEvent('导出成功-总用户数')\r\n                    WxApi.aldEvent('导出成功-' + this.navigateAppArr[index].title)\r\n                },\r\n                fail: (res) => {\r\n                    // 打开失败\r\n                    cancelCB && cancelCB()\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    getSubtitle(index: number) {\r\n        if (this.navigateAppArr[index].subtitle && this.navigateAppArr[index].subtitle != '') {\r\n            return this.navigateAppArr[index].subtitle\r\n        } else {\r\n            return this.navigateAppArr[index].title\r\n        }\r\n    }\r\n\r\n    //加载网络图片\r\n    public loadImgByUrl(sprite, remoteUrl, imageType: string = 'png', cb?: Function) {\r\n        cc.loader.load({\r\n            url: remoteUrl,\r\n            type: imageType\r\n        }, (err, texture) => {\r\n            if (err || !sprite || !texture || !sprite.spriteFrame) {\r\n                return;\r\n            }\r\n            sprite.spriteFrame = new cc.SpriteFrame(texture)\r\n            cb && cb()\r\n        });\r\n    }\r\n\r\n    public loadSpriteFrame(spName: string, sprite: cc.Sprite, cb?: Function) {\r\n        cc.loader.loadRes(spName, cc.SpriteFrame, function (err, spriteFrame) {\r\n            sprite.spriteFrame = spriteFrame\r\n            cb && cb()\r\n        })\r\n    }\r\n\r\n    //打乱数组\r\n    public shuffleArr(arr: any[]) {\r\n        let i = arr.length;\r\n        while (i) {\r\n            let j = Math.floor(Math.random() * i--);\r\n            [arr[j], arr[i]] = [arr[i], arr[j]];\r\n        }\r\n        return arr;\r\n    }\r\n}\r\n"]}