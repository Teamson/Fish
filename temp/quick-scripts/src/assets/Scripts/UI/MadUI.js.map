{"version":3,"sources":["assets\\Scripts\\UI\\MadUI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import JJMgr from \"../../ExportLibs/ExportUtils\";\r\nimport PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nimport AdMgr from \"../Mod/AdMgr\";\r\nimport Utility from \"../Mod/Utility\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MadUI extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    closeBtn: cc.Node = null\r\n\r\n    @property(cc.ProgressBar)\r\n    pBar: cc.ProgressBar = null\r\n\r\n    @property(cc.Node)\r\n    lightPt: cc.Node = null\r\n    @property(cc.Node)\r\n    gun: cc.Node = null\r\n\r\n    hadShowBanner: boolean = false\r\n    hadClick: boolean = false\r\n\r\n    closeCallback: Function = null\r\n    wuchuType: number = 1\r\n    sectionNum: number = 0\r\n\r\n    ptIsPlaying: boolean = false\r\n\r\n    // onLoad () {}\r\n\r\n    start() {\r\n\r\n    }\r\n    onEnable() {\r\n\r\n    }\r\n\r\n    onDisable() {\r\n        this.closeCallback && this.closeCallback()\r\n        WxApi.isKillBossUI = false\r\n    }\r\n\r\n    showUI(closeCallback?: Function) {\r\n\r\n        AdMgr.instance.hideBanner()\r\n        this.closeCallback = closeCallback\r\n        this.node.active = true\r\n        this.closeBtn.active = false\r\n\r\n        this.sectionNum = Utility.getRandomItemInArr(WxApi.splitSection())\r\n\r\n        let randNum: number = Math.random() * 100\r\n        if (randNum <= JJMgr.instance.exportCfg.front_water_type_chance) {\r\n            this.wuchuType = 1\r\n        } else {\r\n            this.wuchuType = 2\r\n        }\r\n\r\n        this.schedule(this.jianshaoBar)\r\n\r\n        WxApi.isKillBossUI = true\r\n        let self = this\r\n\r\n        WxApi.WxOffHide(WxApi.madUICallback)\r\n        WxApi.madUICallback = () => {\r\n            if (WxApi.isKillBossUI) {\r\n                self.unschedule(this.jianshaoBar)\r\n                self.node.active = false\r\n\r\n                let num = Math.floor(Math.random() * 300 + 200)\r\n                PlayerDataMgr.changeCoin(num)\r\n                WxApi.OpenAlert('成功领取' + num + '金币')\r\n            }\r\n        }\r\n        WxApi.WxOnHide(WxApi.madUICallback)\r\n    }\r\n\r\n    closeCB() {\r\n        this.node.active = false\r\n    }\r\n\r\n    closeBtnCB() {\r\n        this.node.active = false\r\n    }\r\n\r\n    clickCB() {\r\n        if (!this.hadClick) {\r\n            this.hadClick = true\r\n            this.scheduleOnce(this.closeCB, JJMgr.instance.exportCfg.front_water_hide / 1000)\r\n\r\n            Utility.delayActive(this.closeBtn, JJMgr.instance.exportCfg.front_close_appear / 1000, this)\r\n        }\r\n\r\n        if (!this.hadShowBanner) {\r\n            if (this.wuchuType == 1) {\r\n                this.hadShowBanner = true\r\n                this.scheduleOnce(() => {\r\n                    this.unschedule(this.jianshaoBar)\r\n                    AdMgr.instance.showBanner()\r\n                }, 1)\r\n            } else {\r\n                if (this.pBar.progress * 100 >= this.sectionNum) {\r\n                    this.hadShowBanner = true\r\n                    this.unschedule(this.jianshaoBar)\r\n                    AdMgr.instance.showBanner()\r\n                }\r\n            }\r\n        }\r\n        this.pBar.progress += 0.1\r\n        if (this.pBar.progress > 0.7) {\r\n            this.pBar.progress = 0.7\r\n        }\r\n\r\n        if (!this.ptIsPlaying) {\r\n            this.gun.angle = -30\r\n            this.gun.stopAllActions()\r\n            this.gun.runAction(cc.rotateTo(0.2, 0))\r\n\r\n            this.ptIsPlaying = true\r\n            this.lightPt.active = true\r\n            this.scheduleOnce(() => {\r\n                this.lightPt.active = false\r\n                this.ptIsPlaying = false\r\n            }, 0.2)\r\n        }\r\n    }\r\n\r\n    jianshaoBar() {\r\n        this.pBar.progress -= 0.003\r\n        if (this.pBar.progress < 0) {\r\n            this.pBar.progress = 0\r\n        }\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}